{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": [
    "Renovate config for Alfa and related project",
    "* Automerge minor/patch dependencies that pass tests, weekly",
    "* Open PR for other dependencies weekly, grouped together"
  ],
  "reviewers": ["team:alfa-owners"],
  "dependencyDashboard": true,
  "allowedPostUpgradeCommands": ["^CI=false yarn dedupe$"],
  "postUpgradeTasks": {
    "description": "Dedupe yarn.lock after updating packages.",
    "task": "CI=false yarn dedupe",
    "executionMode": "branch",
    "fileMatch": ["yarn.lock"]
  },

  "packageRules": [
    {
      "description": "Run major update for non-Alfa packages.These are never automerged and require human approval.",
      "groupName": "Other deps (major)",
      "matchPackagePatterns": ["*"],
      "excludePackagePrefixes": ["@siteimprove/alfa"],
      "schedule": ["before 3am on Monday"],
      },
    {
      "description": "Run patch/minor update and automerge them if tests pass.",
      "groupName": "Other deps (minor/patch)",
      "matchPackagePatterns": ["*"],
      "excludePackagePrefixes": ["@siteimprove/alfa"],
      "matchUpdateTypes": ["minor", "patch"],
      "matchCurrentVersion": "!/^0/",
      "automerge": true,
      "schedule": ["on Sunday"]
    }
  ],
  "extends": ["config:base"]
}
